doctype html
html(lang='en')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    // The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags
    meta(name='description', content='')
    meta(name='author', content='')
    link(rel='icon', href='/favicon.ico')
    title= title
    // Bootstrap core CSS
    link(href='/styles/bootstrap.min.css', rel='stylesheet')
    link(href='/styles/signin.css', rel='stylesheet')
    link(href='/styles/style.css', rel='stylesheet')
    // HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries
    //if lt IE 9
      script(src='https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js')
      script(src='https://oss.maxcdn.com/respond/1.4.2/respond.min.js')
  body
    nav.navbar.navbar-inverse.navbar-fixed-top
        .container
            .navbar-header
                button.navbar-toggle.collapsed(type='button', data-toggle='collapse', data-target='#navbar', aria-expanded='false', aria-controls='navbar')
                    span.sr-only Toggle navigation
                    span.icon-bar
                    span.icon-bar
                    span.icon-bar
                a.navbar-brand(href='#') MeWe Jump

    .container
        form#login-form.form-signin
            h2.form-signin-heading Please sign in
            label.sr-only(for='inputEmail') Email address
            input#inputEmail.form-control(type='email', name="email", placeholder='Email address', required, autofocus)
            label.sr-only(for='inputPassword') Password
            input#inputPassword.form-control(type='password', name="password", placeholder='Password', required)
            .checkbox
              label
                input(type='checkbox', value='remember-me')
                |  Remember me
            #alert_message.alert.hide(role='alert')
            button#signin.btn.btn-lg.btn-primary.btn-block(type='button') Sign in
            p 
                | Don't have an account?
                a.registration(href="/user/registration")  Register here
    // /container
    // SCRIPTS
    script(src="/js/dependencies/sails.io.js")
    script(src="/js/dependencies/jquery.min.js")
    script(src="/js/bootstrap.min.js")
    // SCRIPTS END
    script(src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/jquery.validate.min.js")
    script(src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.14.0/additional-methods.min.js")
    script().
        $(document).ready(function(){
            $("#signin").on("click", function(){
                 $("#alert_message").removeClass("alert-danger alert-success show").addClass("hide")
                var loginForm = $("#login-form");
                loginForm.validate()

                if(loginForm.valid())
                {
                    var user = {
                        email: $("#inputEmail").val(), 
                        password: $("#inputPassword").val()
                    }

                    $.ajax({
                        type: "POST",
                        url: "/user/processLogin",
                        data: user,
                        success: function(response){
                            if(response.success)
                            {
                                window.location.href = response.redirect;
                            }
                            else
                            {
                                $("#alert_message").html(response.message)
                                $("#alert_message").removeClass("alert-success hide").addClass("alert-danger show")
                            }
                        }
                    });

                    //- io.socket.post("/user/processLogin", user, )
                    
                }
            })
        })